\chapter{绪论}\label{chap:introduction}

\section{研究背景}

% 矩阵乘法计算的重要性
% 矩阵乘法需求的变化
% 国产 SW26010P 众核处理器

高性能计算(High-Performance Computing, HPC)又称超级计算，是一种利用超级计算机和数值计算算法对复杂科学、工程和商业问题进行求解的计算机应用。高性能计算的应用领域包括人工智能、天气预报、气候模拟、地震模拟、生物医学、材料科学、工程设计、金融风险分析等。矩阵计算在这些计算应用中会被反复调用，并且在其中耗时较多。随着高性能计算机体系结构不断演进，矩阵计算需求的不断变化，与高性能计算相关的数学软件，特别是矩阵计算库，需要不断优化以适应新的硬件架构和新的矩阵计算需求，才能充分发挥硬件的计算能力。

基础线性代数子程序(Basic Linear Algebra Subprograms)[1]构成了数学库的基石，是高性能计算领域不可或缺的一个组成部分。其广泛应用于科学计算、机器学习，以及人工智能等多个研究前沿。BLAS的高度优化函数是许多大规模计算密集型科学应用的核心依赖，包括但不限于天体物理学、量子化学、大气动力学以及材料科学等。开发和优化高性能BLAS库对于加速这些领域的研究进程，提升计算效率具有至关重要的影响。BLAS 库通常有硬件厂商提出针对特定硬件平台高度优化的版本，例如cuBLAS[2], oneMKL-BLAS[3], AOCL-BLAS[4], rocBLAS[5], APL-BLAS[6]等。另外也有第三方的开源实现例如BLIS[7], MAGMA[8], OpenBLAS[9], GotoBLAS[10] 等

申威系列处理器的硬件架构、指令级、存储层次等一般与通用 CPU、GPU 存在较大差异。为一般商用多核处理器定制的 BLAS 库无法在 SW26010P 上运行，现有开源数学库在设计时也没有考虑异构众核处理器的特点，其优化方案也不能充分发挥申威众核处理器的硬件特性。因此，针对申威众核处理器特有的体系结构设计高性能 BLAS 库十分必要。BLAS 包括向量和矩阵的基本操作，它分为 3 个等级。BLAS 1、2 级函数是典型的访存密集型任务，其性能受限于系统访存带宽，BLAS 3 级函数在大规模条件下是计算密集型任务。

研究表明,BLAS 库中多数 Level-3 计算函数都可以通过调用 GEMM 函数完成, 即,GEMM 函数可以作为整个 Level-3 BLAS 的构建基础。因此, 优化 GEMM 函数便成为高性能 BLAS 库开发工作的重中之重。GEMM 各种计算规模，转置与非转置，低精度、复数等输入类型等变化，会产生组合爆炸的现象，往往需要大量的工作量来应对这些变化。本论文将从自动代码生成与自动调优这一方面展开工作，研究面向申威众核处理器的多规模多精度的稠密矩阵计算代码自动生成系统。该技术在面向新的架构或者其他体系结构时，提供一定的自适应能力，期望能够以极少的修改工作量就能完成适配。在上述架构的基础上，因为存在减少冗余访存带宽的需求，本论文还将研究算子融合，多精度异形矩阵计算等优化策略。具备较高的应用价值，期望推动国产平台上数学库以及相关应用的发展。

本研究面向SW26010-pro 众核处理器进行 BLAS(Basic Linear Algebra Subprograms) 高性能基础线性代数库自动代码生成技术的研究。对 BLAS 进行深度优化，结合代码自动生成技术，实现不同规模下的自动调优框架。同时结合算子融合等技术，推动国产平台上数学库以及相关应用的发展。

\section{研究目标和主要工作}

\subsection{面向矩阵乘法的代码自动生成工具}




\subsection{自适应性能调优}


\subsection{基于DSL的矩阵乘法算子融合拓展}


\section{论文组织结构}
